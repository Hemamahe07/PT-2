def canFinish(numCourses, prerequisites):
    from collections import defaultdict, deque
    g=defaultdict(list); indeg=[0]*numCourses
    for a,b in prerequisites:
        g[b].append(a); indeg[a]+=1
    q=deque([i for i in range(numCourses) if indeg[i]==0])
    done=0
    while q:
        u=q.popleft(); done+=1
        for v in g[u]:
            indeg[v]-=1
            if indeg[v]==0: q.append(v)
    return done==numCourses
